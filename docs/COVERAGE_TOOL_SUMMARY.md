# 新增功能：标定图像覆盖率分析工具

## 📊 功能概述

添加了一个全新的Python工具 `analyze_calibration_coverage.py`，用于分析棋盘格标定图像中角点的分布情况，帮助用户：

- ✅ 可视化角点在整个图像中的分布
- ✅ 识别覆盖率不足的区域
- ✅ 生成详细的统计报告
- ✅ 提供针对性的改进建议

## 🎯 解决的问题

在相机标定过程中，标定图像的质量和分布直接影响标定结果。该工具帮助用户：

1. **避免盲目拍摄** - 清楚地知道哪些区域需要补充图像
2. **提高标定质量** - 确保角点分布均匀，覆盖整个图像区域
3. **节省时间** - 快速识别问题，有针对性地补充图像
4. **量化评估** - 通过数据和可视化评估标定图像集的质量

## 📦 文件清单

### 新增文件
1. **scripts/analyze_calibration_coverage.py** - 主程序（约500行）
   - 角点检测和统计
   - 多种可视化方式
   - 详细报告生成
   
2. **docs/COVERAGE_ANALYSIS.md** - 完整使用文档
   - 详细的功能说明
   - 使用示例和参数说明
   - 常见问题解答
   - 最佳实践建议

3. **docs/COVERAGE_ANALYSIS_QUICK.md** - 快速参考卡片
   - 常用命令速查
   - 参数快速查询
   - 结果解读说明

### 修改文件
- **README.md** - 添加了工具说明和使用示例

## 🚀 快速开始

### 基本用法

```bash
# 分析标定图像目录
python scripts/analyze_calibration_coverage.py --input data/intrinsic_calibration
```

### 保存结果

```bash
python scripts/analyze_calibration_coverage.py \
    --input data/intrinsic_calibration \
    --output results/coverage_analysis.png \
    --report results/coverage_report.txt
```

## 📊 输出示例

工具会生成包含4个子图的可视化结果：

1. **角点散点图** - 显示所有检测到的角点位置
2. **覆盖率热图** - 网格化统计，每格标注角点数量
3. **覆盖率分布图** - 彩色编码（红色=需补充，黄色=一般，绿色=良好）
4. **统计信息** - 详细的数据和改进建议

### 测试结果

在 `diao/` 目录的32张图像上测试：
- ✅ 成功检测：32张（100%）
- ✅ 总角点数：3,072个
- ✅ 图像尺寸：1024×1024
- ⚠️ 发现：边角区域覆盖不足，需要补充

## 💡 使用场景

### 1. 初次标定
在采集完标定图像后，立即运行分析工具，了解图像质量和分布情况。

### 2. 标定失败诊断
如果标定误差较大，使用该工具检查是否存在覆盖率不足的问题。

### 3. 质量保证
在执行标定前，确保图像集满足质量标准。

### 4. 教学演示
可视化展示标定图像的重要性和角点分布的影响。

## 🔧 技术特点

- **智能检测** - 使用OpenCV的棋盘格角点检测，支持亚像素精确化
- **灵活配置** - 支持自定义棋盘格大小和分析网格
- **多种可视化** - 散点图、热图、彩色分布图，多角度展示
- **详细报告** - 生成文本报告，包含每个网格的详细统计
- **跨平台** - 支持Linux/Windows/Mac，使用matplotlib和OpenCV

## 📈 预期效果

使用该工具后，用户可以：

1. **减少标定失败率** - 通过及时发现和补充缺失区域
2. **提高标定精度** - 确保角点分布均匀
3. **节省标定时间** - 避免重复拍摄和标定
4. **建立质量标准** - 为标定图像集设定明确的质量指标

## 🎓 推荐工作流程

```
采集初始图像 (15-20张)
    ↓
运行覆盖率分析 ← 你在这里！
    ↓
识别缺失区域
    ↓
补充标定图像
    ↓
再次运行分析验证
    ↓
执行标定
```

## 📚 相关文档

- [完整使用指南](docs/COVERAGE_ANALYSIS.md)
- [快速参考](docs/COVERAGE_ANALYSIS_QUICK.md)
- [项目README](README.md)

## 🔮 未来改进

可能的扩展方向：

- [ ] 自动建议拍摄位置和角度
- [ ] 与标定结果关联分析
- [ ] 支持视频流实时分析
- [ ] 导出3D可视化
- [ ] 批量处理多个标定集

## ✅ 总结

这个工具填补了标定流程中的一个空白 - **图像质量评估**。通过直观的可视化和详细的统计，用户可以轻松地：

- 📊 **看到** 角点分布
- 🎯 **找到** 缺失区域
- 📈 **改进** 标定质量
- ✨ **提升** 标定成功率

**建议将此工具作为标定流程的标准步骤！**

---

**创建时间**: 2026-02-13  
**版本**: 1.0  
**测试状态**: ✅ 已在实际数据上测试通过
